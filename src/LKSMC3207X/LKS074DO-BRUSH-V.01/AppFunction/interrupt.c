/*******************************************************************************
 *******************************************************************************/
#include "hardware_init.h"
#include "main.h"
#include "foc.h"

uint32_t TimingDelay;

extern s16 test_val1;
volatile u16 mcpwm_cnt;


/*******************************************************************************
 *******************************************************************************/
void ADC0_IRQHandler(void)
{
	  if(ADC_GetIRQFlag(ADC0,ADC_SF1_IF))
		{
		    ADC_ClearIRQFlag(ADC0,ADC_SF1_IF);
		}
		else if(ADC_GetIRQFlag(ADC0,ADC_SF2_IF))
		{
		    ADC_ClearIRQFlag(ADC0,ADC_SF2_IF);
		}
		else
		{
		    ADC_ClearIRQFlag(ADC0,ADC_ALL_IF);
		}
}

void ADC1_IRQHandler(void)
{
    if(ADC_GetIRQFlag(ADC1, ADC_SF1_IF))
		{
			ADC_ClearIRQFlag(ADC1,ADC_SF1_IF);
		}
		else if(ADC_GetIRQFlag(ADC1,ADC_SF2_IF))
		{
		  ADC_ClearIRQFlag(ADC1,ADC_SF2_IF);
		}
		else
		{
		  ADC_ClearIRQFlag(ADC1,ADC_ALL_IF);
		}
}

/*******************************************************************************
 *******************************************************************************/
void MCPWM0_IRQHandler(void)
{
	  if(MCPWM_GetIRQFlag(MCPWM0CNT0, MCPWM0CNT0_T1_IRQ_IF))
		{
      #if (FOC_DGB_IO_EN)
      FOC_DGB_IO_H;
      #endif
      foc_core_isr();
			MCPWM_ClearIRQFlag(MCPWM0CNT0, MCPWM0CNT0_T1_IRQ_IF);
      #if (FOC_DGB_IO_EN)
      FOC_DGB_IO_L;
      #endif
		}

		if(MCPWM_GetIRQFlag(MCPWM0CNT1, MCPWM0_FAIL1_IRQ_IF))
		{
			 MCPWM_ClearIRQFlag(MCPWM0CNT1, MCPWM0_FAIL1_IRQ_IF);
		}


    MCPWM0_EIF = 0xFFFFFFFF;
}
/*******************************************************************************
 *******************************************************************************/
void HALL0_IRQHandler(void)
{
    HALL->INFO = HALL->INFO;    
}

/*******************************************************************************
 *******************************************************************************/
void TIMER0_IRQHandler(void)
{
    UTIMER0_IF = BIT2;
}

/*******************************************************************************
 *******************************************************************************/
void TIMER1_IRQHandler(void)
{

}

/*******************************************************************************
 *******************************************************************************/
void TIMER2_IRQHandler(void)
{

}

/*******************************************************************************
 *******************************************************************************/
void TIMER3_IRQHandler(void)
{

}
/*******************************************************************************
 *******************************************************************************/
void ENCODER0_IRQHandler(void)
{

}

/*******************************************************************************
 *******************************************************************************/
void ENCODER1_IRQHandler(void)
{

}


/*******************************************************************************
 *******************************************************************************/
void CMP_IRQHandler(void)
{
    CMP_IF = BIT0 | BIT1;

    if(CMP_IF & (BIT1))
    {
        volatile u8 t_bi, t_bcnt;

        t_bcnt = 0;
        for(t_bi = 0; t_bi < 5; t_bi++)
        {
            if(CMP_DATA & BIT15) /* BIT14 CMP0 OUT Flag| BIT15 CMP1 OUT Flag */
            {   
                t_bcnt ++;
            }
        }

        if(t_bcnt > 3)
        {
            PWMOutputs(DISABLE);
            MCPWM0_EIF = BIT4|BIT5;
        }
    }
}



/*******************************************************************************
 *******************************************************************************/
void UART0_IRQHandler(void)
{

}

/*******************************************************************************
 *******************************************************************************/
void UART1_IRQHandler(void)
{
  

}

/*******************************************************************************
 *******************************************************************************/
void SysTick_Handler(void)
{
	if (TimingDelay != 0x00)
  { 
    TimingDelay--;
  }

  user_1ms_call();
}

/*******************************************************************************
 *******************************************************************************/
void SleepTimer_IRQHandler(void)
{
    while(1);
}

/*******************************************************************************
 *******************************************************************************/
void GPIO_IRQHandler(void)
{

}

void QEP0_IRQHandler(void)
{
}
void QEP1_IRQHandler(void)
{
}
/*******************************************************************************
 *******************************************************************************/
void I2C0_IRQHandler(void)
{

}

/*******************************************************************************
 *******************************************************************************/
void SPI0_IRQHandler(void)
{

}

void DSP0_IRQHandler(void)
{
}

void MCPWM1_IRQHandler(void)
{
}

void SIF0_IRQHandler  (void)
{
}
void WAKE_IRQHandler  (void)
{
}
void SW_IRQHandler    (void)
{
}
void PWRDN_IRQHandler (void)
{
}
void CL0_IRQHandler   (void)
{
}
/************************ (C) COPYRIGHT LINKO SEMICONDUCTOR **********************/
/* ------------------------------END OF FILE------------------------------------ */


